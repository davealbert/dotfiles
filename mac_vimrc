execute pathogen#infect()


"g:multi_cursor_exit_from_insert_mode (Default: 1)
"g:multi_cursor_exit_from_visual_mode (Default: 1)
let g:multi_cursor_exit_from_insert_mode=0

"let $XIKI_DIR = "/Library/Ruby/Gems/1.8/gems/xiki-0.6.3"
"source $XIKI_DIR/etc/vim/xiki.vim

imap £ #
cmap £ #
map £ #

map <f7> :tabp<CR>
map <f8> :tabn<CR>

set backup
set backupdir=~/.vim/backup
set directory=~/.vim/tmp
set spelllang=en_gb
set smartindent
set tabstop=2
set number
map <C-l> :set nu!<CR>

nnoremap <silent> <C-a> :let _s=@/<Bar>:%s/\s\+$//e<Bar>:let @/=_s<Bar>:nohl<CR>


set shiftwidth=2
set ai                  " auto indenting
set history=10000       " keep 100 lines of history
set ruler               " show the cursor position
set showcmd
set ignorecase
syntax on               " syntax highlighting
set hlsearch            " highlight the last searched term
:nnoremap <CR> :nohlsearch<cr>

filetype plugin on      " use the file type plugins

" When editing a file, always jump to the last cursor position
autocmd BufReadPost *
\ if ! exists("g:leave_my_cursor_position_alone") |
\ if line("'\"") > 0 && line ("'\"") <= line("$") |
\ exe "normal g'\"" |
\ endif |
\ endif

" {{{1 GUI

if has('gui_running')
    set lines=70
    set columns=100
    set guioptions=cM
    set guicursor=a:blinkon0
    set cursorline

    if has("gui_win32")
        set guifont=Consolas:h10:cDEFAULT
    elseif has("gui_macvim")
        set guifont=Monaco:h12.00
        map <D-t> :CommandT<CR>
    endif

    if has('spell')
        set spell
        set spelllang=en_gb
        set spellfile=~/.vim/spell/spellfile.add
        set spellsuggest=best,10
    endif
endif

"FROM G.B.
set cursorline

"disable arrow keys
map <up> :echo 'No!'<cr>
map <down> :echo 'No!'<cr>
map <left> :echo 'No!'<cr>
map <right> :echo 'No!'<cr>
imap <up> :echo 'No!'<cr>
imap <down> :echo 'No!'<cr>
imap <left> :echo 'No!'<cr>
imap <right> :echo 'No!'<cr>

set expandtab
set tabstop=4
set shiftwidth=4
set softtabstop=4
set autoindent

set shell=bash
"set shell=/bin/bash\ -i


"Lighter looking colors"
"set t_Co=8 " 256 colors
"set background=dark
color grb256
set t_Co=256
"color railscasts


set switchbuf=useopen
let mapleader=","
set showtabline=2
set cmdheight=2
syntax on

""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" RENAME CURRENT FILE
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
function! RenameFile()
    let old_name = expand('%')
    let new_name = input('New file name: ', expand('%'), 'file')
    if new_name != '' && new_name != old_name
        exec ':saveas ' . new_name
        exec ':silent !rm ' . old_name
        redraw!
    endif
endfunction
map <leader>n :call RenameFile()<cr>



"Command-T
"  Ctrl-p to access
"     Ctrl-t to open in new tab
map <C-p> <Esc>:CommandT<CR>
imap <C-p> <Esc>:CommandT<CR>


inoremap jk <esc>
inoremap <esc> <esc>:echo 'No! Use: jk '<cr>i

" Insert the next charachter pressed and shift the rest of the line right
" <space><space>  would add one space.
nmap <Space> i_jkr



"Remove whitespace on save
autocmd BufWritePre *.py :%s/\s\+$//e
autocmd BufWritePre *.php :%s/\s\+$//e
autocmd BufWritePre *.html :%s/\s\+$//e
autocmd BufWritePre *.css :%s/\s\+$//e
autocmd BufWritePre *.js :%s/\s\+$//e
autocmd BufWritePre .*rc :%s/\s\+$//e

nmap <C-s> :w<CR>
"imap <c-s> <Esc>:w<CR>a
imap <C-s> <Esc><C-s>


map <Leader>t :tabnew<Enter>
map <Leader>w :close<Enter>

command! Browser :! open -a Google\ Chrome.app %:p


set wildmenu



"PhpUnit Testing
function! RunPhpUnitTest(...)
    :w
    :silent !echo;echo;echo;echo;echo;echo;echo;echo;echo;
    :silent !echo;echo;echo;echo;echo;echo;echo;echo;echo;
    :silent !echo;echo;echo;echo;echo;echo;echo;echo;echo;
    :silent !echo;echo;echo;echo;echo;echo;echo;echo;echo;
    :silent !echo;echo;echo;echo;echo;echo;echo;echo;echo;
    :silent !echo;echo;echo;echo;echo;echo;echo;echo;echo;
    if a:0
        let file = a:1
        :exec '!phpunit ' . file
    else
        :!phpunit
    endif

endfunction

map <Leader>R :call RunPhpUnitTest()<cr>
map <Leader>r :call RunPhpUnitTest(@%)<cr>


cnoremap %% <C-R>=expand('%:h').'/'<cr>

map <Leader>a :!php artisan



"Bubble single lines (kicks butt)
""http://vimcasts.org/episodes/bubbling-text/
nmap <C-k> ddkP
nmap <C-j> ddp

"Bubble multiple lines
vmap <C-k> xkP`[V`]
vmap <C-j> xp`[V`]


set laststatus=2
set statusline=%f\ -\ FileType:\ %y
hi StatusLine ctermbg=Black ctermfg=Black

"Much nicer filename autocompletion
"set wildmode=list:longest,list
set wildmode=longest:full,full
